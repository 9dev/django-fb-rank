
language: python

python:
  - 3.4
services:
  - selenium: "2.43"

env:
  global:
    - DISPLAY=:99.0
    # DJANGO_SETTINGS_MODULE

branches:
  only:
    - master

install:
  - pip install -r demo/requirements.txt

before_script: 
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage
  - "curl -o /tmp/chromedriver.zip -L http://chromedriver.storage.googleapis.com/2.21/chromedriver_linux64.zip"
  - "unzip /tmp/chromedriver.zip -d /home/shippable/bin"
  - "chmod +x /home/shippable/bin/chromedriver"
  - "echo '#!/bin/bash' | sudo tee /usr/bin/google-chrome"
  - "echo 'exec /usr/bin/chrome --no-sandbox --disable-gpu \"$@\"' | sudo tee -a /usr/bin/google-chrome"
  - "sudo chmod +x /usr/bin/google-chrome"
  - "sudo mv /usr/bin/google-chrome /usr/bin/chromedriver"
  #- mysql -e 'create database test;'
  - /etc/init.d/xvfb start

script:
  - python demo/manage.py test fts --pattern="*" -v 2

after_script:
  #- coverage here...
  - /etc/init.d/xvfb stop

archive: true
